<?xml version="1.0"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009"
		 xmlns:s="library://ns.adobe.com/flex/spark"
		 xmlns:mx="library://ns.adobe.com/flex/mx">
		<fx:Style>
			@namespace s "library://ns.adobe.com/flex/spark";

			.videoCount {
				color: #000000;
				font-size: 40;
			}

		</fx:Style>
	<fx:Script><![CDATA[
		import assets.images.videos;

		import collaboRhythm.plugins.videoMessages.controller.VideoMessagesAppController;
		import collaboRhythm.shared.model.CollaborationLobbyNetConnectionService;
		import collaboRhythm.shared.model.healthRecord.document.VideoMessagesModel;

		import mx.events.CollectionEvent;

		private var _videoMessagesAppController:VideoMessagesAppController;
		[Bindable]
		private var _videoMessagesModel:VideoMessagesModel;
		[Bindable]
		private var _collaborationLobbyNetConnectionService:CollaborationLobbyNetConnectionService;
		[Bindable]
		private var _videoMessageCount:int;

		public function init(videoMessagesAppController:VideoMessagesAppController,
							 videoMessagesModel:VideoMessagesModel,
							 collaborationLobbyNetConnectionService:CollaborationLobbyNetConnectionService):void
		{
			_videoMessagesAppController = videoMessagesAppController;
			_videoMessagesModel = videoMessagesModel;
			_collaborationLobbyNetConnectionService = collaborationLobbyNetConnectionService;

			_videoMessagesModel.videoMessagesCollection.addEventListener(CollectionEvent.COLLECTION_CHANGE,
																		 videoMessagesCollection_changeHandler);
			_videoMessageCount = _videoMessagesModel.videoMessagesCollection.length;
		}

		private function videoMessagesCollection_changeHandler(event:CollectionEvent):void
		{
			_videoMessageCount = _videoMessagesModel.videoMessagesCollection.length;
			showFullViewButton.label = _videoMessageCount.toString();
		}

		private function showFullViewButton_clickHandler():void
		{
			_videoMessagesAppController.dispatchShowFullView();
		}
		]]></fx:Script>
	<s:Button id="showFullViewButton" icon="{videos}" label="0" width="100" height="100" click="showFullViewButton_clickHandler()" skinClass="collaboRhythm.shared.view.IconButtonSkin" styleName="videoCount" enabled="{_collaborationLobbyNetConnectionService.isConnected &amp;&amp; _videoMessageCount != 0}"/>
</s:Group>
